{"version":3,"sources":["useSliderThumb.ts"],"names":["clamp","getSliderThumbId","sliderIds","useRef","useState","useLabel","useMove","isRTL","useSliderThumb","opts","state","isReversed","index","isDisabled","trackLayout","isVertical","orientation","direction","undefined","labelId","get","labelProps","fieldProps","trim","stateRef","current","reverseX","currentPosition","startPosition","setStartPosition","moveProps","onMoveStart","setThumbDragging","size","height","width","getThumbPercent","onMove","deltaX","deltaY","delta","position","setThumbPercent","onMoveEnd","setThumbEditable","onAccessibilityAction","event","max","getThumbMinValue","min","getThumbMaxValue","value","getThumbValue","incrementValue","Math","step","decrementValue","nativeEvent","actionName","setThumbValue","inputProps","now","name","label","thumbProps"],"mappings":"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","sourcesContent":["import { AriaSliderThumbProps } from '@react-types/slider';\nimport { clamp } from '@react-aria/utils';\nimport { getSliderThumbId, sliderIds } from './utils';\nimport { useRef, useState } from 'react';\nimport { SliderState } from '@react-stately/slider';\nimport { useLabel } from '@react-aria/label';\nimport { useMove } from './useMove';\nimport { isRTL } from '@react-native-aria/utils';\n\ninterface SliderThumbAria {\n  /** Props for the root thumb element; handles the dragging motion. */\n  thumbProps: any;\n\n  /** Props for the visually hidden range input element. */\n  inputProps: any;\n\n  /** Props for the label element for this thumb (optional). */\n  labelProps: any;\n}\n\ninterface SliderThumbOptions extends AriaSliderThumbProps {\n  /** A ref to the track element. */\n  trackLayout: any;\n  /** A ref to the thumb input element. */\n  inputRef: any;\n}\n\n/**\n * Provides behavior and accessibility for a thumb of a slider component.\n *\n * @param opts Options for this Slider thumb.\n * @param state Slider state, created via `useSliderState`.\n */\nexport function useSliderThumb(\n  opts: SliderThumbOptions,\n  state: SliderState,\n  isReversed?: boolean\n): SliderThumbAria {\n  let { index, isDisabled, trackLayout } = opts;\n\n  let isVertical = opts.orientation === 'vertical';\n  const direction = isRTL() ? 'rtl' : undefined;\n\n  let labelId = sliderIds.get(state);\n  const { labelProps, fieldProps } = useLabel({\n    ...opts,\n    'id': getSliderThumbId(state, index),\n    'aria-labelledby': `${labelId} ${opts['aria-labelledby'] ?? ''}`.trim(),\n  });\n\n  const stateRef = useRef<SliderState>(null);\n  stateRef.current = state;\n  let reverseX = isReversed || direction === 'rtl';\n  let currentPosition = useRef<number>(null);\n\n  const [startPosition, setStartPosition] = useState(0);\n\n  let { moveProps } = useMove({\n    onMoveStart() {\n      state.setThumbDragging(index, true);\n      let size = isVertical ? trackLayout.height : trackLayout.width;\n      setStartPosition(stateRef.current.getThumbPercent(index) * size);\n    },\n    onMove({ deltaX, deltaY }) {\n      let size = isVertical ? trackLayout.height : trackLayout.width;\n\n      if (currentPosition.current == null) {\n        currentPosition.current =\n          stateRef.current.getThumbPercent(index) * size;\n      }\n\n      let delta = isVertical ? deltaY : deltaX;\n      if (reverseX) {\n        if (!isVertical) {\n          delta = -delta;\n        }\n      } else {\n        if (isVertical) {\n          delta = -delta;\n        }\n      }\n\n      const position = startPosition + delta;\n\n      stateRef.current.setThumbPercent(index, clamp(position / size, 0, 1));\n    },\n    onMoveEnd() {\n      state.setThumbDragging(index, false);\n    },\n  });\n\n  state.setThumbEditable(index, !isDisabled);\n\n  const onAccessibilityAction = (event: any) => {\n    const max = state.getThumbMinValue(index);\n    const min = state.getThumbMaxValue(index);\n    const value = state.getThumbValue(index);\n\n    const incrementValue = Math.min(value + state.step ?? 1, max);\n    const decrementValue = Math.max(value - state.step ?? 1, min);\n\n    switch (event.nativeEvent.actionName) {\n      case 'increment':\n        state.setThumbValue(index, incrementValue);\n        break;\n      case 'decrement':\n        state.setThumbValue(index, decrementValue);\n        break;\n      default:\n        break;\n    }\n  };\n\n  return {\n    inputProps: {\n      ...fieldProps,\n      'disabled': isDisabled,\n      'role': 'adjustable',\n      'aria-value': {\n        min: state.getThumbMinValue(index),\n        max: state.getThumbMaxValue(index),\n        now: state.getThumbValue(index),\n      },\n      'accessibilityActions': [\n        {\n          name: 'increment',\n          label: 'Increment',\n        },\n        {\n          name: 'decrement',\n          label: 'Decrement',\n        },\n      ],\n      onAccessibilityAction,\n    },\n    thumbProps: !isDisabled ? moveProps : {},\n    labelProps,\n  };\n}\n"]}