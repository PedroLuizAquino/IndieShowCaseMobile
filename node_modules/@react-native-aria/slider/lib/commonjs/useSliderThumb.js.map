{"version":3,"sources":["useSliderThumb.ts"],"names":["useSliderThumb","opts","state","isReversed","index","isDisabled","trackLayout","isVertical","orientation","direction","undefined","labelId","sliderIds","get","labelProps","fieldProps","trim","stateRef","current","reverseX","currentPosition","startPosition","setStartPosition","moveProps","onMoveStart","setThumbDragging","size","height","width","getThumbPercent","onMove","deltaX","deltaY","delta","position","setThumbPercent","onMoveEnd","setThumbEditable","onAccessibilityAction","event","max","getThumbMinValue","min","getThumbMaxValue","value","getThumbValue","incrementValue","Math","step","decrementValue","nativeEvent","actionName","setThumbValue","inputProps","now","name","label","thumbProps"],"mappings":"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","sourcesContent":["import { AriaSliderThumbProps } from '@react-types/slider';\nimport { clamp } from '@react-aria/utils';\nimport { getSliderThumbId, sliderIds } from './utils';\nimport { useRef, useState } from 'react';\nimport { SliderState } from '@react-stately/slider';\nimport { useLabel } from '@react-aria/label';\nimport { useMove } from './useMove';\nimport { isRTL } from '@react-native-aria/utils';\n\ninterface SliderThumbAria {\n  /** Props for the root thumb element; handles the dragging motion. */\n  thumbProps: any;\n\n  /** Props for the visually hidden range input element. */\n  inputProps: any;\n\n  /** Props for the label element for this thumb (optional). */\n  labelProps: any;\n}\n\ninterface SliderThumbOptions extends AriaSliderThumbProps {\n  /** A ref to the track element. */\n  trackLayout: any;\n  /** A ref to the thumb input element. */\n  inputRef: any;\n}\n\n/**\n * Provides behavior and accessibility for a thumb of a slider component.\n *\n * @param opts Options for this Slider thumb.\n * @param state Slider state, created via `useSliderState`.\n */\nexport function useSliderThumb(\n  opts: SliderThumbOptions,\n  state: SliderState,\n  isReversed?: boolean\n): SliderThumbAria {\n  let { index, isDisabled, trackLayout } = opts;\n\n  let isVertical = opts.orientation === 'vertical';\n  const direction = isRTL() ? 'rtl' : undefined;\n\n  let labelId = sliderIds.get(state);\n  const { labelProps, fieldProps } = useLabel({\n    ...opts,\n    'id': getSliderThumbId(state, index),\n    'aria-labelledby': `${labelId} ${opts['aria-labelledby'] ?? ''}`.trim(),\n  });\n\n  const stateRef = useRef<SliderState>(null);\n  stateRef.current = state;\n  let reverseX = isReversed || direction === 'rtl';\n  let currentPosition = useRef<number>(null);\n\n  const [startPosition, setStartPosition] = useState(0);\n\n  let { moveProps } = useMove({\n    onMoveStart() {\n      state.setThumbDragging(index, true);\n      let size = isVertical ? trackLayout.height : trackLayout.width;\n      setStartPosition(stateRef.current.getThumbPercent(index) * size);\n    },\n    onMove({ deltaX, deltaY }) {\n      let size = isVertical ? trackLayout.height : trackLayout.width;\n\n      if (currentPosition.current == null) {\n        currentPosition.current =\n          stateRef.current.getThumbPercent(index) * size;\n      }\n\n      let delta = isVertical ? deltaY : deltaX;\n      if (reverseX) {\n        if (!isVertical) {\n          delta = -delta;\n        }\n      } else {\n        if (isVertical) {\n          delta = -delta;\n        }\n      }\n\n      const position = startPosition + delta;\n\n      stateRef.current.setThumbPercent(index, clamp(position / size, 0, 1));\n    },\n    onMoveEnd() {\n      state.setThumbDragging(index, false);\n    },\n  });\n\n  state.setThumbEditable(index, !isDisabled);\n\n  const onAccessibilityAction = (event: any) => {\n    const max = state.getThumbMinValue(index);\n    const min = state.getThumbMaxValue(index);\n    const value = state.getThumbValue(index);\n\n    const incrementValue = Math.min(value + state.step ?? 1, max);\n    const decrementValue = Math.max(value - state.step ?? 1, min);\n\n    switch (event.nativeEvent.actionName) {\n      case 'increment':\n        state.setThumbValue(index, incrementValue);\n        break;\n      case 'decrement':\n        state.setThumbValue(index, decrementValue);\n        break;\n      default:\n        break;\n    }\n  };\n\n  return {\n    inputProps: {\n      ...fieldProps,\n      'disabled': isDisabled,\n      'role': 'adjustable',\n      'aria-value': {\n        min: state.getThumbMinValue(index),\n        max: state.getThumbMaxValue(index),\n        now: state.getThumbValue(index),\n      },\n      'accessibilityActions': [\n        {\n          name: 'increment',\n          label: 'Increment',\n        },\n        {\n          name: 'decrement',\n          label: 'Decrement',\n        },\n      ],\n      onAccessibilityAction,\n    },\n    thumbProps: !isDisabled ? moveProps : {},\n    labelProps,\n  };\n}\n"]}